function cssGetPropertyValue(n,t){for(var r,o=new String,s=document.styleSheets,u,f,e,i=0;i<s.length;i++)for(u=s[i],f=u.rules||u.cssRules,r=0;r<f.length;r++)e=f[r],e.selectorText==n&&(o=e.style.getPropertyValue(t));return o}function cssSetPropertyValue(n,t,i){for(var u,s=document.styleSheets,f,e,o,r=0;r<s.length;r++)for(f=s[r],e=f.rules||f.cssRules,u=0;u<e.length;u++)o=e[u],o.selectorText==n&&o.style.setProperty(t,i)}function cssLockStyleDisplay(){_css_display_none=[];_css_display_block=[]}function cssSetStyleDisplay(n,t){_css_display_none==null?n.style.display=t?"block":"none":t?_css_display_block[_css_display_block.length]=n:_css_display_none[_css_display_none.length]=n}function cssSetStyleDisplayById(n,t){cssSetStyleDisplay(document.getElementById(n),t)}function cssUnlockStyleDisplay(){for(var n=0;n<_css_display_none.length;n++)_css_display_none[n].style.display="none";for(n=0;n<_css_display_block.length;n++)_css_display_block[n].style.display="block";_css_display_none=null;_css_display_block=null}function canUseCookie(){return navigator.cookieEnabled}function setExpiresDate(n){_cookie_expires=new Date(currentTimeMillis()+n*864e5).toGMTString()}function _getCookieArray(){return document.cookie.split(";")}function _getCookieParam(n){var t=n.split("=");return t[0]=t[0].replace(new RegExp("^\\s+"),""),t}function cookieNum(){return document.cookie.length==0?0:_getCookieArray().length}function getCookieKey(n){var t,i;return document.cookie.length==0?"":(t=_getCookieArray(),n>=t.length)?"":(i=_getCookieParam(t[n]),i[0])}function getCookie(n,t){for(var r,u=_getCookieArray(),i=0;i<u.length;i++)if(r=_getCookieParam(u[i]),r[0]==n)return unescape(r[1]);return t}function setCookie(n,t){var i,r;t==null&&(t="");i=_cookie_expires;t.length==0&&(r=new Date,r.setTime(0),i=r.toGMTString());document.cookie=n+"="+escape(t)+"; expires="+i}function clearCookie(n){for(var i,r=_getCookieArray(),t=r.length-1;t>=0;t--)i=_getCookieParam(r[t]),(n==undefined||i[0].indexOf(n)==0)&&setCookie(i[0],"")}function beginCookieRead(n){_cookie_val=getCookie(n,"");_cookie_s=0}function cookieRead(){if(_cookie_s>=_cookie_val.length)_cookie_str="";else{var n=_cookie_val.indexOf("&",_cookie_s);n<0&&(n=_cookie_val.length);_cookie_str=_cookie_val.substring(_cookie_s,n);_cookie_s=n+1}return unescape(_cookie_str)}function endCookieRead(){_cookie_val="";_cookie_str=""}function beginCookieWrite(){_cookie_val=""}function cookieWrite(n){_cookie_val.length>0&&(_cookie_val+="&");_cookie_val+=escape(n)}function endCookieWrite(n){setCookie(n,_cookie_val);_cookie_val=""}function canUseStorage(){try{return window.localStorage!=null}catch(n){}return!1}function storageNum(){return window.localStorage.length}function getStorageKey(n){return n>=storageNum()?"":window.localStorage.key(n)}function getStorage(n,t){var i=window.localStorage.getItem(n);return i==null?t:i}function setStorage(n,t){t!=null&&t.length>0?window.localStorage.setItem(n,t):window.localStorage.removeItem(n)}function clearStorage(n){var r,i,t;if(n==undefined)window.localStorage.clear();else for(r=storageNum(),t=r-1;t>=0;t--)i=getStorageKey(t),(n==undefined||i.indexOf(n)==0)&&setStorage(i,null)}function beginStorageRead(n){_storage_val=getStorage(n,"");_storage_s=0}function storageRead(){if(_storage_s>=_storage_val.length)_storage_str="";else{var n=_storage_val.indexOf("&",_storage_s);n<0&&(n=_storage_val.length);_storage_str=_storage_val.substring(_storage_s,n);_storage_s=n+1}return unescape(_storage_str)}function endStorageRead(){_storage_val="";_storage_str=""}function beginStorageWrite(){_storage_val=""}function storageWrite(n){_storage_val.length>0&&(_storage_val+="&");_storage_val+=escape(n)}function endStorageWrite(n){setStorage(n,_storage_val);_storage_val=""}function _Preference(n){this.s=n&&canUseStorage();this.c=canUseCookie()}function consoleBreak(){return _console_break}function _Console(n){window.onConsoleUpdate==undefined&&(window.onConsoleUpdate=function(){});this._id=n;this._div=document.getElementById(this._id);this._html="";this._blankLine="";this._maxLen=0;this._color="";this._lastColor="";this._bold=!1;this._italic=!1;this._lock=!1;this._needUpdate=!1}function onConsoleUpdate(){con.scrollBottom()}function _Error(){window.onError==undefined&&(window.onError=function(){});this._message=new String;this._name=new String;this._description=new String;this._number=new String;this._file=new String;this._line=new String;this._column=new String;this._stack=new String}function catchError(n){var t=new _Error;t._message=n.message;t._name=n.name;n.description&&(t._description=n.description);n.number&&(t._number=""+n.number);n.fileName&&(t._file=n.fileName);n.lineNumber&&(t._line=""+n.lineNumber);n.columnNumber&&(t._column=""+n.columnNumber);n.stack&&(t._stack=n.stack);onError(t)}function clip_onerror(n,t,i){var r=new _Error;return r._message=n,r._file=t,r._line=i,onError(r),!0}function onError(n){con.newLine();con.setColor("ff0000");con.println("<b>message:<\/b> "+n.message());con.println("<b>name:<\/b> "+n.name());con.println("<b>description:<\/b> "+n.description());con.println("<b>number:<\/b> "+n.number());con.println("<b>file:<\/b> "+n.file());con.println("<b>line:<\/b> "+n.line());con.println("<b>column:<\/b> "+n.column());var t=new _String(n.stack());t.escape().replaceNewLine(consoleBreak());con.println("<b>stack:<\/b> "+t.str());con.setColor()}function _CanvasEnv(){this._color_r=0;this._color_g=0;this._color_b=0;this._color_a=255;this._font="";this._stroke_width=1}function setCanvasEnv(n){_canvas_env=n}function _Canvas(n){n==undefined?(this._canvas=document.createElement("canvas"),this._create=!0):(this._canvas=document.getElementById(n),this._create=!1);this._context=this._canvas.getContext("2d");this._resetContext()}function canvasSetSize(n,t){var r,i,u;n<=0||t<=0?(canvas.setSize(1,1),r=document.getElementById("gworld_buttonarea"),r.style.display="none",i=document.getElementById("gworld_canvasarea"),i.style.width="1px",i.style.height="1px",i.style.display="none",u=document.getElementById("body"),u.style.width="640px"):(r=document.getElementById("body"),r.style.width=""+(640+n+2+5)+"px",i=document.getElementById("gworld_canvasarea"),i.style.width=""+n+"px",i.style.height=""+t+"px",i.style.display="block",u=document.getElementById("gworld_buttonarea"),u.style.display="block",canvas.setSize(n,t))}function canvasZoomIn(){canvasScale<canvasMinScale+2&&(canvasScale++,canvas.setStrokeWidth(canvasScale),canvasSetSize(procGWorld()._width*canvasScale,procGWorld()._height*canvasScale),gUpdate(procGWorld()))}function canvasZoomOut(){canvasScale>canvasMinScale&&(canvasScale--,canvas.setStrokeWidth(canvasScale),canvasSetSize(procGWorld()._width*canvasScale,procGWorld()._height*canvasScale),gUpdate(procGWorld()))}function canvasClear(){canvas.setColorRGB(gWorldBgColor());canvas.fill(0,0,canvas.width(),canvas.height())}function canvasSetColor(n){canvas.setColorBGR(n)}function canvasPut(n,t){canvas.fill(n*canvasScale,t*canvasScale,canvasScale,canvasScale)}function canvasFill(n,t,i,r){canvas.fill(n*canvasScale,t*canvasScale,i*canvasScale,r*canvasScale)}function canvasLine(n,t,i,r){canvas.line(n,t,i,r,canvasScale)}function canUseFile(){return window.FileReader&&window.FileList&&window.File}function _InputFile(n){window.onInputFileLoadImage==undefined&&(window.onInputFileLoadImage=function(){});window.onInputFileLoad==undefined&&(window.onInputFileLoad=function(){});window.onInputFileLoadEnd==undefined&&(window.onInputFileLoadEnd=function(){});this._input=document.getElementById(n);this._input.addEventListener("change",_onInputFileChange,!1)}function _onInputFileChange(n){var t=n.target.files,f,r,u,i;if(t.length!=0){if(t[0].type.startsWith("image/")){f=t[0].name;i=new FileReader;i.onload=function(){var n=new Image;n.onload=function(){onInputFileLoadImage(f,n)};n.src=i.result};i.readAsDataURL(t[0]);return}for(_input_file_cnt=0,_input_file_num=t.length,r=0;r<t.length;r++)u=t.item(r),i=new FileReader,i.onload=function(n){return function(t){var r,u,e,i,h,c,f,o,s;if(n.name.indexOf(".cef")>0){for(u=t.target.result,e=n.name.substring(0,n.name.indexOf(".cef")),i=0;i<u.length;i++)if(!isCharSpace(u,i)&&u.charAt(i)!="\t")break;if(h=u.substring(i,i+11),h.toLowerCase()=="#!namespace"){for(c=new _String(u),f=c.replaceNewLine().str(),f.indexOf("\n")<0&&(f+="\n"),o=new String,r=i+11;;r++)if(!isCharSpace(f,r)&&f.charAt(r)!="\t")break;if(r>i+11){for(;;r++){if(s=f.charAt(r),isCharSpace(f,r)||s=="\t"||s=="\n")break;o+=s}o.length>0&&(e=o+":"+e)}}onInputFileLoad(e,u);_input_file_cnt++;_input_file_cnt>=_input_file_num&&onInputFileLoadEnd(_input_file_cnt)}}}(u),i.readAsText(u)}}function drawInputFileImage(n,t,i){var r=procGWorld()._width,u=procGWorld()._height;return r>0&&u>0?(n.width<=r&&n.height<=u?(r=n.width,u=n.height):n.width/n.height<r/u?r=_INT(n.width*u/n.height):u=_INT(n.height*r/n.width),t.set(r),i.set(u),canvas.drawImage(n,r,u),canvas.imageData(r,u).data):null}function onInputFileLoadImage(n,t){var u=new _Integer,f=new _Integer,e=drawInputFileImage(t,u,f),i,r;e!=null&&(i=u._val,r=f._val,con.setBold(!0),con.println("["+n+"]"),(i!=t.width||r!=t.height)&&con.print(""+t.width+"x"+t.height+" -&gt; "),con.println(""+i+"x"+r),con.setBold(!1))}function doCommandGGet24Begin(n,t){var i=procGWorld()._width,r=procGWorld()._height;return i>0&&r>0?(n.set(i),t.set(r),canvas.imageData(i,r).data):null}function doCommandGGet24End(){}function __ProcError(){this._err=0;this._num=0;this._func=new String;this._token=new String;this._before=null;this._next=null}function _ProcError(){this._top=null;this._end=null;this._num=0}function getProcErrorDefString(n,t,i,r){var u=new String;switch(n){case _CLIP_PROC_WARN_ARRAY:u=r?"Array element number is negative.":"配列の要素番号が負の値です";break;case _CLIP_PROC_WARN_DIV:u=r?"Divide by zero.":"ゼロで除算しました";break;case _CLIP_PROC_WARN_UNDERFLOW:u=r?"Underflowed.":"アンダーフローしました";break;case _CLIP_PROC_WARN_OVERFLOW:u=r?"Overflow occurred.":"オーバーフローしました";break;case _CLIP_PROC_WARN_ASIN:u=r?'Argument of "asin" is out of the range of -1 to 1.':"asinの引数が-1から1の範囲外になりました";break;case _CLIP_PROC_WARN_ACOS:u=r?'Argument of "acos" is out of the range of -1 to 1.':"acosの引数が-1から1の範囲外になりました";break;case _CLIP_PROC_WARN_ACOSH:u=r?'Argument of "acosh" now has value less than 1.':"acoshの引数が1未満の値になりました";break;case _CLIP_PROC_WARN_ATANH:u=r?'The argument of "atanh" is less than or equal to -1 or 1 or more.':"atanhの引数が-1以下または1以上の値になりました";break;case _CLIP_PROC_WARN_LOG:u=r?'Argument of "'+(i?"ln":"log")+'" is 0 or negative value.':(i?"ln":"log")+"の引数が0または負の値になりました";break;case _CLIP_PROC_WARN_LOG10:u=r?'Argument of "'+(i?"log":"log10")+'" has become 0 or negative value.':(i?"log":"log10")+"の引数が0または負の値になりました";break;case _CLIP_PROC_WARN_SQRT:u=r?'Argument of "sqrt" has a negative value.':"sqrtの引数が負の値になりました";break;case _CLIP_PROC_WARN_FUNCTION:u=r?'Invalid argument for "'+t+'".':t+"の引数が無効です";break;case _CLIP_PROC_WARN_RETURN:u=r?'"return" can not return a value.':"returnで値を返すことができません";break;case _CLIP_PROC_WARN_DEAD_TOKEN:u=r?"Token is not executed.":"実行されないトークンです";break;case _CLIP_PROC_WARN_SE_RETURN:u=r?'"$RETURN_A" can not return a value.':"$RETURN_Aで値を返すことができません";break;case _CLIP_LOOP_ERR_NULL:u=r?"There is no token.":"トークンがありません";break;case _CLIP_LOOP_ERR_COMMAND:u=r?"Command not supported.":"コマンドはサポートされていません";break;case _CLIP_LOOP_ERR_STAT:u=r?"Control structure is not supported.":"制御構造はサポートされていません";break;case _CLIP_PROC_ERR_UNARY:u=r?'"'+t+'": Unary operator expression is incorrect.':t+":単項演算子表現が間違っています";break;case _CLIP_PROC_ERR_OPERATOR:u=r?'"'+t+'": Operator expression is wrong.':t+":演算子表現が間違っています";break;case _CLIP_PROC_ERR_ARRAY:u=r?'"'+t+'": Array representation is incorrect.':t+":配列表現が間違っています";break;case _CLIP_PROC_ERR_FUNCTION:u=r?'Argument of function "'+t+'" is wrong.':"関数"+t+"の引数が間違っています";break;case _CLIP_PROC_ERR_LVALUE:u=r?'The left side of "'+t+'" must be a variable or an array.':t+"の左辺は変数または配列でなければなりません";break;case _CLIP_PROC_ERR_RVALUE:u=r?'The right side of "'+t+'" must be a variable or an array.':t+"の右辺は変数または配列でなければなりません";break;case _CLIP_PROC_ERR_RVALUE_NULL:u=r?'There is no right side of "'+t+'".':t+"の右辺がありません";break;case _CLIP_PROC_ERR_CONDITIONAL:u=r?'Two constant or variable are not specified on the right side of the ternary operator "'+t+'".':"三項演算子"+t+"の右辺に定数または変数が2個指定されていません";break;case _CLIP_PROC_ERR_EXTFUNC:u=r?'Execution of the external function "'+t.slice(1)+'" was interrupted.':"外部関数"+t.slice(1)+"の実行が中断されました";break;case _CLIP_PROC_ERR_USERFUNC:u=r?'Execution of function "'+t+'" was interrupted.':"関数"+t+"の実行が中断されました";break;case _CLIP_PROC_ERR_CONSTANT:u=r?'"'+t+'": Constant expression is wrong.':t+":定数表現が間違っています";break;case _CLIP_PROC_ERR_STRING:u=r?'"'+t+'": String representation is incorrect.':t+":文字列表現が間違っています";break;case _CLIP_PROC_ERR_COMPLEX:u=r?'"'+t+'": Wrong complex number representation.':t+":複素数表現が間違っています";break;case _CLIP_PROC_ERR_FRACT:u=r?'"'+t+'": Fractional representation is incorrect.':t+":分数表現が間違っています";break;case _CLIP_PROC_ERR_ASS:u=r?'Assignment to a constant by "'+t+'" is invalid.':t+"による定数への代入は無効です";break;case _CLIP_PROC_ERR_CALL:u=r?"Function call failed.":"関数呼び出しに失敗しました";break;case _CLIP_PROC_ERR_EVAL:u=r?"Execution of evaluation was interrupted.":"evalの実行が中断されました";break;case _CLIP_PROC_ERR_STAT_IF:u=r?'"'+t+'" too many nests.':t+"のネスト数が多すぎます";break;case _CLIP_PROC_ERR_STAT_ENDIF:u=r?'There is no "if" corresponding to "'+t+'".':t+"に対応するifがありません";break;case _CLIP_PROC_ERR_STAT_SWITCH:u=r?'"'+t+'" too many nests.':t+"のネスト数が多すぎます";break;case _CLIP_PROC_ERR_STAT_ENDSWI:u=r?'There is no "switch" corresponding to "'+t+'".':t+"に対応するswitchがありません";break;case _CLIP_PROC_ERR_STAT_UNTIL:u=r?'No "do" corresponding to "'+t+'".':t+"に対応するdoがありません";break;case _CLIP_PROC_ERR_STAT_ENDWHILE:u=r?'There is no "while" corresponding to "'+t+'".':t+"に対応するwhileがありません";break;case _CLIP_PROC_ERR_STAT_FOR_CON:u=r?'No condition part in "'+t+'".':t+"における条件部がありません";break;case _CLIP_PROC_ERR_STAT_FOR_EXP:u=r?'There is no update expression in "'+t+'".':t+"における更新式がありません";break;case _CLIP_PROC_ERR_STAT_NEXT:u=r?'There is no "for" corresponding to "'+t+'".':t+"に対応するforがありません";break;case _CLIP_PROC_ERR_STAT_CONTINUE:u=r?'"'+t+'" is invalid.':t+"は無効です";break;case _CLIP_PROC_ERR_STAT_BREAK:u=r?'"'+t+'" is invalid.':t+"は無効です";break;case _CLIP_PROC_ERR_STAT_FUNC:u=r?"Too many functions.":"関数の数が多すぎます";break;case _CLIP_PROC_ERR_STAT_FUNC_NEST:u=r?"Function can not be defined in function.":"関数内で関数は定義できません";break;case _CLIP_PROC_ERR_STAT_ENDFUNC:u=r?'There is no "func" corresponding to "'+t+'".':t+"に対応するfuncがありません";break;case _CLIP_PROC_ERR_STAT_FUNCNAME:u=r?'"'+t+'": Function name is invalid.':t+":関数名は無効です";break;case _CLIP_PROC_ERR_STAT_FUNCPARAM:u=r?'"'+t+'": Label can not be set for function argument.':t+":関数の引数にラベル設定できません";break;case _CLIP_PROC_ERR_STAT_LOOP:u=r?"Number of loops exceeded the upper limit.":"ループ回数オーバーしました";break;case _CLIP_PROC_ERR_COMMAND_NULL:u=r?"The command is incorrect.":"コマンドが間違っています";break;case _CLIP_PROC_ERR_COMMAND_PARAM:u=r?'The argument of the command "'+t.slice(1)+'" is incorrect.':"コマンド"+t.slice(1)+"の引数が間違っています";break;case _CLIP_PROC_ERR_COMMAND_DEFINE:u=r?'"'+t+'" has already been defined.':t+"は既に定義されています";break;case _CLIP_PROC_ERR_COMMAND_UNDEF:u=r?'"'+t+'" is not defined.':t+"は定義されていません";break;case _CLIP_PROC_ERR_COMMAND_PARAMS:u=r?'You can only specify up to 10 arguments for the command "'+t.slice(1)+'".':"コマンド"+t.slice(1)+"の引数は10個までしか指定できません";break;case _CLIP_PROC_ERR_FUNC_OPEN:u=r?'The external function "'+t.slice(1)+'" can not be opened.':"外部関数"+t.slice(1)+"がオープンできません";break;case _CLIP_PROC_ERR_FUNC_PARANUM:u=r?"Up to 10 arguments of external function can be specified.":"外部関数の引数は10個までしか指定できません";break;case _CLIP_PROC_ERR_FUNC_PARACODE:u=r?'"token": The argument of the external function must be a constant, variable or array name.':t+":外部関数の引数は定数、変数または配列名でなければなりません";break;case _CLIP_PROC_ERR_SE_NULL:u=r?"The single expression is incorrect.":"単一式が間違っています";break;case _CLIP_PROC_ERR_SE_OPERAND:u=r?"Operand of the single expression is incorrect.":"単一式のオペランドが間違っています";break;case _CLIP_PROC_ERR_SE_LOOPEND:u=r?'No "$LOOPSTART" corresponding to "$LOOPEND".':"$LOOPENDに対応する$LOOPSTARTがありません";break;case _CLIP_PROC_ERR_SE_LOOPCONT:u=r?'No "$LOOPSTART" corresponding to "$LOOPCONT".':"$LOOPCONTに対応する$LOOPSTARTがありません";break;case _CLIP_PROC_ERR_SE_CONTINUE:u=r?'"$CONTINUE" is invalid.':"$CONTINUEは無効です";break;case _CLIP_PROC_ERR_SE_BREAK:u=r?'"$BREAK" is invalid.':"$BREAKは無効です"}return u}function setEditorSmartFlag(n){_editor_smart=n}function editorSmartFlag(){return _editor_smart}function _Editor(n){window.onEditorUpdateText==undefined&&(window.onEditorUpdateText=function(){});this._textarea=document.getElementById(n);this._textarea.addEventListener("input",_onEditorInput,!1);this._textarea.addEventListener("keydown",_onEditorKeyDown,!1)}function _onEditorInput(n){var f=n.target,t=f.selectionStart,i,r,u;if(_editor_smart&&t>0&&t!=_editor_cursor_pos&&(i=f.value,i.length>_editor_text.length))if(isCharSpace(i,t-1)){if(t==1||i.charAt(t-2)=="\t")f.value=i.substr(0,t-1)+"\t"+i.slice(t),f.setSelectionRange(t,t);else if(i.charAt(t-2)=="\n"){for(r=t-3;r>=0;r--)if(i.charAt(r)=="\n")break;for(r++,u="";i.charAt(r)=="\t";)u+="\t",r++;u.length==0&&(u="\t");f.value=i.substr(0,t-1)+u+i.slice(t);f.setSelectionRange(t-1+u.length,t-1+u.length)}}else if(i.charAt(t-1)=="\n"){for(r=t-2;r>=0;r--)if(i.charAt(r)=="\n")break;for(r++,u="";i.charAt(r)=="\t";)u+="\t",r++;f.value=i.substr(0,t)+u+i.slice(t);f.setSelectionRange(t+u.length,t+u.length)}_editor_cursor_pos=f.selectionStart;_editor_text=f.value;onEditorUpdateText(_editor_text.length)}function _onEditorKeyDown(n){var i=n.target,r,t,u,f;if(n.keyCode==9){if(n.preventDefault(),r=i.value,t=i.selectionStart,_editor_smart&&t>0&&r.charAt(t-1)=="\n"){for(u=t-2;u>=0;u--)if(r.charAt(u)=="\n")break;for(u++,f="";r.charAt(u)=="\t";)f+="\t",u++;f.length==0&&(f="\t");i.value=r.substr(0,t)+f+r.slice(t);i.setSelectionRange(t+f.length,t+f.length)}else i.value=r.substr(0,t)+"\t"+r.slice(t),i.setSelectionRange(t+1,t+1);_editor_text=i.value;onEditorUpdateText(_editor_text.length)}_editor_cursor_pos=i.selectionStart}function canUseWriteFile(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")!=-1}function writeFile(n,t){window.onWriteFileEnd==undefined&&(window.onWriteFileEnd=function(){});var i=encodeURI(t).replace(new RegExp("%..","g"),"*").length;webkitRequestFileSystem(TEMPORARY,i,function(i){i.root.getFile(n,{create:!0},function(n){n.createWriter(function(i){i.onwriteend=function(){onWriteFileEnd(n)};i.onerror=function(){};i.write(new Blob([t],{type:"text/plain"}))},function(){})},function(){})},function(){})}function main(n,t,i,r,u){var f,h,e,o,s,l,c;if(defGWorldFunction(),defProcFunction(),h=window.navigator.userAgent,(h.indexOf("Android")!=-1||h.indexOf("iPad")!=-1)&&(document.getElementById("clip_loadextfunc").style.display="none",document.getElementById("command_pc").style.display="none",h.indexOf("iPad")!=-1&&(document.documentElement.addEventListener("touchstart",function(n){n.touches.length>1&&n.preventDefault()},!0),document.documentElement.addEventListener("touchend",function(n){var t=(new Date).getTime();t-lastTouchEnd<=500&&n.preventDefault();lastTouchEnd=t},!0),useStorage=!1)),preference=new _Preference(useStorage),input=document.getElementById(n),con=new _Console(t),con.setMaxBlankLine(1),con.setMaxLen(conMaxLen),regGWorldDefCharInfo(0),regGWorldDefCharInfoLarge(1),regGWorldBgColor(12632256),setCanvasEnv(new _CanvasEnv),canvas=new _Canvas(i),canvasClear(),inputFile=new _InputFile(r),procError=new _ProcError,setDefineValue(),setProcEnv(new _ProcEnv),topProc=new _Proc(_PROC_DEF_PARENT_MODE,_PROC_DEF_PRINT_ASSERT,_PROC_DEF_PRINT_WARN,_PROC_DEF_GUPDATE_FLAG),topProc._printAns=!0,setProcWarnFlowFlag(!0),setProcTraceFlag(traceLevel>0),setProcLoopMax(loopMax),topParam=new _Param,topParam._enableCommand=!0,topParam._enableOpPow=!1,topParam._enableStat=!0,setGlobalParam(topParam),regCustomCommand("env",_CLIP_COMMAND_CUSTOM),regCustomCommand("list",_CLIP_COMMAND_CUSTOM+1),regCustomCommand("listd",_CLIP_COMMAND_CUSTOM+2),regCustomCommand("extfunc",_CLIP_COMMAND_CUSTOM+3),regCustomCommand("usage",_CLIP_COMMAND_CUSTOM+4),regCustomCommand("english",_CLIP_COMMAND_CUSTOM+5),regCustomCommand("japanese",_CLIP_COMMAND_CUSTOM+6),regCustomCommand("test",_CLIP_COMMAND_CUSTOM+7),regCustomCommand("trace",_CLIP_COMMAND_CUSTOM+8),srand(time()),rand(),dispCache){if(canUseStorage())for(e=storageNum(),con.println("<b>Storage: "+e+"<\/b>"),f=0;f<e;f++)o=getStorageKey(f),con.print("<b>["+o+"]<\/b> "),con.println(new _String(getStorage(o,"")).escape().str());if(canUseCookie())for(e=cookieNum(),con.println("<b>Cookie: "+e+"<\/b>"),f=0;f<e;f++)o=getCookieKey(f),con.print("<b>["+o+"]<\/b> "),con.println(new _String(getCookie(o,"")).escape().str())}for(loadExtFuncFile(),editor=new _Editor(u),s=parseInt(preference.get("_CLIP_EDITOR_Tab","4")),s<0&&(s=0),document.getElementById("tab_width").value=""+s,cssSetPropertyValue(".textarea_func","tab-size",""+s),l=parseInt(preference.get("_CLIP_EDITOR_Smart","1"))==1,document.getElementById("check_smart").checked=l,setEditorSmartFlag(l),selFunc=parseInt(preference.get("_CLIP_EDITOR_SelFunc","0")),c=document.getElementById("select_func"),f=0;f<c.options.length;f++)c.options[f].selected=f==selFunc?!0:!1;curFunc=c.options[selFunc].value;loadFunc();updateSelectFunc();con.println("CLIP Copyright (C) SatisKia");englishFlag=parseInt(preference.get("_CLIP_ENV_Language","0"))==1;updateLanguage()}function doShowConsole(){saveFunc();document.getElementById("button_console").innerHTML="<img src='icon1.png' width='20' height='20'>";document.getElementById("button_editor").innerHTML="<img src='icon7.png' width='16' height='16'>";document.getElementById("clip_editor").style.display="none";document.getElementById("clip_console").style.display="block"}function doShowEditor(){document.getElementById("button_console").innerHTML="<img src='icon1.png' width='16' height='16'>";document.getElementById("button_editor").innerHTML="<img src='icon7.png' width='20' height='20'>";document.getElementById("clip_console").style.display="none";document.getElementById("clip_editor").style.display="block"}function proc(){var n=""+input.value;n.length>0&&(doShowConsole(),con.newLine(),con.println("<b>&gt;<\/b>"+n),con.lock(),lockGUpdate&&(needGUpdate=!1),initProcLoopCount(),testFlag&&topProc.testProcessLoop(n,topParam),topProc.processLoop(n,topParam),lockGUpdate&&needGUpdate&&(gUpdate(procGWorld()),needGUpdate=!1),dispLoopCount>0&&(procLoopCount()>0||procLoopTotal()>0)&&(con.newLine(),con.setColor("0000ff"),procLoopCount()>0&&(dispLoopCount>1&&con.println("loop "+procLoopCount()),resetProcLoopCount()),procLoopCountMax()>0&&con.println("max loop "+procLoopCountMax()),procLoopTotal()>0&&con.println("total loop "+procLoopTotal()),con.setColor()),con.unlock());input.value=""}function doClearFuncCache(){topProc.clearAllFuncCache()}function doClearStorage(){canUseStorage()&&(document.getElementById("button_storage_clear").disabled=!0,clearStorage("_CLIP_TMP_"),location.replace("index.html"))}function doClearCookie(){canUseCookie()&&(document.getElementById("button_cookie_clear").disabled=!0,clearCookie("_CLIP_TMP_"),location.replace("index.html"))}function makeExtFuncData(n,t){for(var o=n.length,u,e,s,i,r,f;o>0;){if(!isCharEnter(n,o-1))break;o--}if(n=n.substr(0,o),t&&(u=new _String(n),u.escape(),u.replace("\r\n","<span style='color:#0000FF'>\\r\\n<\/span>"+consoleBreak()),u.replace("\r","<span style='color:#0000FF'>\\r<\/span>"+consoleBreak()),u.replace("\n","<span style='color:#0000FF'>\\n<\/span>"+consoleBreak()),con.println(u.str())),e=new _String(n),e.replaceNewLine(),e.str().indexOf("\n")<0)return s=[],s[0]=e.str(),s;for(i=e.str().split("\n"),r=0;r<i.length;r++)for(f=0;f<i[r].length;f++)if(!isCharSpace(i[r],f)&&i[r].charAt(f)!="\t"){i[r]=i[r].slice(f);break}return i}function loadExtFuncFile(){var n,t;for(preference.beginRead("_CLIP_TMP_LOADCEF_"),n=0;;n++){if(file=preference.read(),file.length==0)break;extFuncFile[n]=file}for(preference.endRead(),n=0;n<extFuncFile.length;n++)t=preference.get("_CLIP_TMP_"+extFuncFile[n],""),t.length>0&&(dispCache&&con.println("<b>["+(useStorage&&canUseStorage()?"storage":"cookie")+" "+extFuncFile[n]+"]<\/b>"),extFuncData[n]=makeExtFuncData(t,dispCache),dispCache&&(englishFlag?con.println("<b>"+extFuncData[n].length+" lines<\/b>"):con.println("<b>"+extFuncData[n].length+"行<\/b>")))}function onInputFileLoad(n,t){var i,u,r;for(topProc.clearFuncCache(n),u="/"+n+".cef",r=extFuncFile.length,i=0;i<extFuncFile.length;i++)if(extFuncFile[i]==u){r=i;break}for(con.println("<b>["+(r==extFuncFile.length?"new":"update")+" "+u+"]<\/b>"),extFuncFile[r]=u,extFuncData[r]=makeExtFuncData(t,!0),englishFlag?con.println("<b>"+extFuncData[r].length+" lines<\/b>"):con.println("<b>"+extFuncData[r].length+"行<\/b>"),t="",i=0;i<extFuncData[r].length;i++)i!=0&&(t+="\n"),t+=extFuncData[r][i];for(preference.beginWrite(),i=0;i<extFuncFile.length;i++)preference.write(extFuncFile[i]);preference.endWrite("_CLIP_TMP_LOADCEF_");preference.set("_CLIP_TMP_"+extFuncFile[r],t)}function onInputFileLoadEnd(){englishFlag?con.println("<b>Completed.<\/b>"):con.println("<b>完了しました<\/b>")}function extFuncName(n){var t=n.lastIndexOf("/"),i;return t>=0&&(t++,i=n.lastIndexOf(".cef"),i>=0)?n.substring(t,i):""}function getExtFuncDataDirect(n){return n.charAt(0)=="!"&&n.length==2?makeExtFuncData(getFunc(n.charAt(1)),!0):null}function getExtFuncDataNameSpace(n){for(var t=0;t<extFuncFile.length;t++)if(extFuncName(extFuncFile[t])==n&&t<extFuncData.length)return extFuncData[t];return null}function mainProc(n,t,i,r,u,f){var e;return e=u.mainLoop(i,f,r,t),dispLoopCount>0&&procLoopCount()>0&&(dispLoopCount>1&&(con.newLine(),con.setColor("0000ff"),f._funcName!=null&&con.print(f._funcName+": "),con.println("loop "+procLoopCount()),con.setColor()),resetProcLoopCount()),e}function assertProc(n,t){return con.newLine(),t!=null&&t.length>0&&con.print(t+": "),n>0&&(englishFlag?con.print("Line "+n+": "):con.print(""+n+"行: ")),englishFlag?con.println("Error "+intToString(_CLIP_ERR_ASSERT,16,4)+": Failed to assert."):con.println("エラー("+intToString(_CLIP_ERR_ASSERT,16,4)+"): アサートに失敗しました"),retAssertProc}function getErrorString(n,t,i,r){var u=new String,f=getProcErrorDefString(n,r,topParam._calculator,englishFlag);return f.length>0&&(i!=null&&i.length>0&&(u+=i+": "),t>0&&(u+=englishFlag?"Line "+t+": ":""+t+"行: "),u+=englishFlag?((n&_CLIP_PROC_WARN)!=0?"Warning":"Error")+" "+intToString(n,16,4)+": "+f:((n&_CLIP_PROC_WARN)!=0?"警告":"エラー")+"("+intToString(n,16,4)+"): "+f),u}function errorProc(n,t,i,r){if(silentErr)procError.add(n,t,i,r);else{var u=getErrorString(n,t,i,r);u.length>0&&(con.newLine(),con.println(u))}}function codeString(n){var t=new String;switch(n){case _CLIP_CODE_TOP:t="TOP";break;case _CLIP_CODE_VARIABLE:t="VARIABLE";break;case _CLIP_CODE_AUTO_VAR:t="AUTO_VAR";break;case _CLIP_CODE_GLOBAL_VAR:t="GLOBAL_VAR";break;case _CLIP_CODE_ARRAY:t="ARRAY";break;case _CLIP_CODE_AUTO_ARRAY:t="AUTO_ARRAY";break;case _CLIP_CODE_GLOBAL_ARRAY:t="GLOBAL_ARRAY";break;case _CLIP_CODE_CONSTANT:t="CONSTANT";break;case _CLIP_CODE_LABEL:t="LABEL";break;case _CLIP_CODE_COMMAND:t="COMMAND";break;case _CLIP_CODE_STATEMENT:t="STATEMENT";break;case _CLIP_CODE_OPERATOR:t="OPERATOR";break;case _CLIP_CODE_FUNCTION:t="FUNCTION";break;case _CLIP_CODE_EXTFUNC:t="EXTFUNC";break;case _CLIP_CODE_NULL:t="NULL";break;case _CLIP_CODE_END:t="END";break;case _CLIP_CODE_ARRAY_TOP:t="ARRAY_TOP";break;case _CLIP_CODE_ARRAY_END:t="ARRAY_END";break;case _CLIP_CODE_MATRIX:t="MATRIX";break;case _CLIP_CODE_STRING:t="STRING";break;case _CLIP_CODE_PARAM_ANS:t="PARAM_ANS";break;case _CLIP_CODE_PARAM_ARRAY:t="PARAM_ARRAY";break;default:t=""+n}return t}function printTrace(n,t,i,r,u){var f=new String,o,s,e,h;for(n._funcName!=null&&(f+=""+n._funcName+":"),n._fileFlag&&(f+=""+i+": "),u&&(f+="SKIP "),t.beginGetToken(),e=0;t.getTokenParam(n);){if(o=getCode(),s=getToken(),traceString+=e==0?f:" ",traceString+=(new _Token).tokenString(n,o,s),traceLevel>=2){if(traceLevel==3&&o==_CLIP_CODE_LABEL)for(h=0;h<s.length;h++)traceString+=","+s.charCodeAt(h);traceString+="("+codeString(o)+")"}e++}r!=null&&(traceString+=e==0?f:" ",traceString+="#"+r);(e>0||r!=null)&&(traceString+="\n")}function printTest(n,t,i,r){var f=new String,e,o,u,s;for(n._funcName!=null&&(f+=""+n._funcName+":"),n._fileFlag&&(f+=""+i+": "),t.beginGetToken(),u=0;t.getTokenParam(n);){if(e=getCode(),o=getToken(),u==0?con.print(f):con.print(" "),con.print((new _Token).tokenString(n,e,o)),traceLevel>=2){if(con.setColor("0000ff"),traceLevel==3&&e==_CLIP_CODE_LABEL)for(s=0;s<o.length;s++)con.print(","+o.charCodeAt(s));con.print("("+codeString(e)+")");con.setColor()}u++}r!=null&&(u==0&&con.print(f),con.setColor("007f00"),con.print(" #"+new _String(r).escape().str()),con.setColor());(u>0||r!=null)&&con.println()}function getArrayTokenString(n,t,i,r,u){var c=new _Token,o,f,h,e=new String,s=!1;for(t.beginGetToken();t.getToken();){if(f=getCode(),h=getToken(),s){if(f==_CLIP_CODE_ARRAY_TOP)for(e+=u,o=0;o<i;o++)e+=r;s=!1}e+=c.tokenString(n,f,h);e+=r;f==_CLIP_CODE_ARRAY_TOP&&(i+=2);f==_CLIP_CODE_ARRAY_END&&(i-=2,s=!0)}return e}function printMatrix(n,t,i){con.println(getArrayTokenString(n,t,i,"&nbsp;",consoleBreak()))}function printAnsMatrix(n,t){con.newLine();con.setBold(!0);printMatrix(n,t,0);con.setBold(!1)}function printAnsComplex(n,t){con.newLine();con.setBold(!0);con.println(n+t);con.setBold(!1)}function printWarn(n,t,i){con.newLine();i!=null&&i.length>0&&con.print(i+": ");t>0&&(englishFlag?con.print("Line "+t+": "):con.print(""+t+"行: "));englishFlag?con.println("Warning: "+n):con.println("警告: "+n)}function printError(n,t,i){con.newLine();i!=null&&i.length>0&&con.print(i+": ");t>0&&(englishFlag?con.print("Line "+t+": "):con.print(""+t+"行: "));englishFlag?con.println("Error: "+n):con.println("エラー: "+n)}function doFuncGColor(n){return doFuncGColorBGR(n,COLOR_WIN)}function doFuncGColor24(n){return _RGB2BGR(COLOR_WIN[n])}function doFuncEval(n,t,i,r,u){return n.doFuncEval(t,i,r,u)}function doCommandClear(){con.clear()}function doCommandPrint(n,t){var i,r;for(con.setColor("ff00ff"),i=n;i!=null;)i._string!=null&&(r=new _String(i._string),r.escape().replaceNewLine(consoleBreak()),con.print(r.str())),i=i._next;t&&con.println();con.setColor()}function skipCommandLog(){return traceLevel==0}function doCommandLog(n){for(var t=n;t!=null;)t._string!=null&&(traceString+=t._string),t=t._next;traceString+="\n"}function doCommandScan(n,t,i){for(var f=new String,u=new String,r=n;r!=null;)f=r.getDefString(t,i),u=prompt(r.title(),f),(u==null||u.length==0)&&(u=f),r.setNewValue(u,t,i),r=r._next}function doCommandGWorld(n,t){canvasScale=n<canvasMinSize||t<canvasMinSize?_CEIL(canvasMinSize/(n<t?n:t)):1;canvasMinScale=canvasScale;canvas.setStrokeWidth(canvasScale);canvasSetSize(n*canvasScale,t*canvasScale)}function gWorldClear(n,t){if(lockGUpdate){needGUpdate=!0;return}canvasClear();canvasSetColor(COLOR_WIN[t]);canvasFill(0,0,n._width,n._height);canvasSetColor(COLOR_WIN[n._color])}function gWorldSetColor(n,t){lockGUpdate||canvasSetColor(COLOR_WIN[t])}function gWorldPutColor(n,t,i,r){if(lockGUpdate){needGUpdate=!0;return}topProc._gUpdateFlag&&(canvasSetColor(COLOR_WIN[r]),canvasPut(t,i),canvasSetColor(COLOR_WIN[n._color]))}function gWorldPut(n,t,i){if(lockGUpdate){needGUpdate=!0;return}topProc._gUpdateFlag&&canvasPut(t,i)}function gWorldFill(n,t,i,r,u){if(lockGUpdate){needGUpdate=!0;return}topProc._gUpdateFlag&&canvasFill(t,i,r,u)}function gWorldLine(n,t,i,r,u){if(lockGUpdate){needGUpdate=!0;return}topProc._gUpdateFlag&&canvasLine(t,i,r,u)}function gWorldTextColor(){if(lockGUpdate){needGUpdate=!0;return}}function doCommandGColor(n,t){COLOR_WIN[n]=_RGB2BGR(t);needGUpdate=!0}function doCommandGPut24(n,t,i){canvas.setColorRGB(i);canvasPut(n,t)}function doCommandGPut24End(){canvasSetColor(COLOR_WIN[procGWorld()._color]);needGUpdate=!1}function gUpdate(n){canvasClear();for(var f=n._image,e=n._offset,o=n._width,s=n._height,t,r,u,i=0;i<s;i++)for(r=i*e,u=i*canvasScale,t=0;t<o;t++)canvasSetColor(COLOR_WIN[f[r+t]]),canvas.fill(t*canvasScale,u,canvasScale,canvasScale);canvasSetColor(COLOR_WIN[n._color])}function doCommandGUpdate(n){if(lockGUpdate){needGUpdate=!0;return}gUpdate(n)}function doCommandPlot(n,t,i,r,u,f){var o=new _Proc(t._mode,n._printAssert,n._printWarn,!1),e=new _Param(n._curLine._num,t,!0);e._enableCommand=!1;e._enableStat=!1;n.doCommandPlot(o,e,i,r,u,f);e.end();o.end()}function doCommandRePlot(n,t,i,r,u,f){var o=new _Proc(t._mode,n._printAssert,n._printWarn,!1),e=new _Param(n._curLine._num,t,!0);e._enableCommand=!1;e._enableStat=!1;n.doCommandRePlot(o,e,i,r,u,f);e.end();o.end()}function doCommandUsage(n){addExtFuncList||con.setColor("ff00ff");for(var t=n;t!=null;){if(t._string!=null){if(con.print(new _String(t._string).escape().str()),addExtFuncList)break;con.println()}t=t._next}addExtFuncList||con.setColor()}function doCommandDumpVar(n,t){var e=new _Token,r=new _String,u=new _String,f,i="";e.valueToString(n,n.val(t),r,u);(f=n._var._label._label[t])!=null?(i=f,n._var._label._flag[t]!=_LABEL_MOVABLE&&(i+="(@"+String.fromCharCode(t)+")")):i="@"+String.fromCharCode(t);traceString+=i+"="+r.str()+u.str();traceString+="\n"}function doCommandDumpArray(n,t){var r=new _Token,u,i="";n._array.makeToken(r,t);(u=n._array._label._label[t])!=null?(i=u,n._array._label._flag[t]!=_LABEL_MOVABLE&&(i+="(@@"+String.fromCharCode(t)+")")):i="@@"+String.fromCharCode(t);i+=" ";traceString+=i+getArrayTokenString(n,r,i.length," ","\n");traceString+="\n"}function doCustomCommand(n,t,i,r){var b,g,y,tt,w,a,f,k,e,d,p,v;switch(r){case _CLIP_COMMAND_CUSTOM+5:case _CLIP_COMMAND_CUSTOM+6:englishFlag=r==_CLIP_COMMAND_CUSTOM+5?!0:!1;englishFlag?con.print("Change English mode. "):con.print("Change Japanese mode. ");updateLanguage();preference.set("_CLIP_ENV_Language",englishFlag?"1":"0");break;case _CLIP_COMMAND_CUSTOM:con.setColor("0000ff");con.println("calculator "+(t._calculator?"TRUE":"FALSE"));con.println(t._base==0?"zero-based":"one-based");switch(t._mode){case _CLIP_MODE_E_FLOAT:con.print("efloat");break;case _CLIP_MODE_F_FLOAT:con.print("float");break;case _CLIP_MODE_G_FLOAT:con.print("gfloat");break;case _CLIP_MODE_E_COMPLEX:con.print("ecomplex");break;case _CLIP_MODE_F_COMPLEX:con.print("complex");break;case _CLIP_MODE_G_COMPLEX:con.print("gcomplex");break;case _CLIP_MODE_I_FRACT:con.print("fract");break;case _CLIP_MODE_M_FRACT:con.print("mfract");break;case _CLIP_MODE_H_TIME:con.print("htime");break;case _CLIP_MODE_M_TIME:con.print("mtime");break;case _CLIP_MODE_S_TIME:con.print("time");break;case _CLIP_MODE_F_TIME:con.print("ftime");break;case _CLIP_MODE_S_CHAR:con.print("char");break;case _CLIP_MODE_U_CHAR:con.print("uchar");break;case _CLIP_MODE_S_SHORT:con.print("short");break;case _CLIP_MODE_U_SHORT:con.print("ushort");break;case _CLIP_MODE_S_LONG:con.print("long");break;case _CLIP_MODE_U_LONG:con.print("ulong")}con.print(", ");con.print("fps "+t._fps);con.print(", ");con.print("prec "+t._prec);con.print(", ");con.print("radix "+t._radix);con.print(", ");b=new _Integer;g=new _Boolean;n.getAngType(b,g);switch(b._val){case _ANG_TYPE_RAD:con.print("rad");break;case _ANG_TYPE_DEG:con.print("deg");break;case _ANG_TYPE_GRAD:con.print("grad")}con.println();con.print("assert "+(n._printAssert?"TRUE":"FALSE"));con.print(", ");con.print("warn "+(n._printWarn?"TRUE":"FALSE"));con.println();var it=procGWorld().wndPosX(0),rt=procGWorld().wndPosY(0),ut=procGWorld().wndPosX(procGWorld()._width),ft=procGWorld().wndPosY(procGWorld()._height);con.println("gworld "+procGWorld()._width+" "+procGWorld()._height);con.println("window "+it+" "+ft+" "+ut+" "+rt);switch(procGraph().mode()){case _GRAPH_MODE_RECT:con.print("rectangular");break;case _GRAPH_MODE_PARAM:con.print("parametric");break;case _GRAPH_MODE_POLAR:con.print("polar")}con.print(", ");procGraph().isLogScaleX()?con.print("logscale x "+procGraph().logBaseX()):con.print("nologscale x");con.print(", ");procGraph().isLogScaleY()?con.print("logscale y "+procGraph().logBaseY()):con.print("nologscale y");con.println();con.setColor();break;case _CLIP_COMMAND_CUSTOM+1:case _CLIP_COMMAND_CUSTOM+2:if(n._curLine._token.getTokenParam(t)){if(y=getCode(),p=getToken(),(y&_CLIP_CODE_ARRAY_MASK)!=0){y==_CLIP_CODE_GLOBAL_ARRAY&&(t=globalParam());var u=n.arrayIndexIndirect(t,y,p),nt=new _Token,h,c="";t._array.makeToken(nt,u);(h=t._array._label._label[u])!=null?(c=h,t._array._label._flag[u]!=_LABEL_MOVABLE?c+="(@@"+String.fromCharCode(u)+")":r==_CLIP_COMMAND_CUSTOM+2&&(c+="(@@:"+u+")")):c="@@"+String.fromCharCode(u);c+=" ";con.setColor("0000ff");con.print(c);printMatrix(t,nt,c.length);con.setColor();break}else if(y==_CLIP_CODE_EXTFUNC&&(tt=new _String(p),w=n.getExtFuncData(tt,null),w!=null)){for(con.setColor("0000ff"),f=0;f<w.length;f++)con.println(new _String(w[f]).escape().str());con.setColor();break}}else{var l=new _Token,u,o=new _String,s=new _String,h;for(con.setColor("0000ff"),a=0;a<4;a++){for(e=[],f=0,u=0;u<256;u++)u==0?a==3&&((h=t._var._label._label[u])!=null?(l.valueToString(t,t.val(u),o,s),e[f]=h+"(@)="+o.str()+s.str(),f++):t.isZero(u)||(l.valueToString(t,t.val(u),o,s),e[f]="@ ="+o.str()+s.str(),f++)):u==_CHAR_CODE_EX||u>=_CHAR_CODE_0&&u<=_CHAR_CODE_9?a==1&&((h=t._var._label._label[u])!=null?(l.valueToString(t,t.val(u),o,s),e[f]=h+"(@"+String.fromCharCode(u)+")="+o.str()+s.str(),f++):t.isZero(u)||(l.valueToString(t,t.val(u),o,s),e[f]="@"+String.fromCharCode(u)+"="+o.str()+s.str(),f++)):(a==0&&(h=t._var._label._label[u])!=null&&t._var._label._flag[u]==_LABEL_MOVABLE&&(l.valueToString(t,t.val(u),o,s),e[f]=r==_CLIP_COMMAND_CUSTOM+2?h+"(@:"+u+")="+o.str()+s.str():h+"="+o.str()+s.str(),f++),a==2&&((h=t._var._label._label[u])!=null?t._var._label._flag[u]!=_LABEL_MOVABLE&&(l.valueToString(t,t.val(u),o,s),e[f]=h+"(@"+String.fromCharCode(u)+")="+o.str()+s.str(),f++):t.isZero(u)||(l.valueToString(t,t.val(u),o,s),e[f]="@"+String.fromCharCode(u)+"="+o.str()+s.str(),f++)));for(e.sort(function(n,t){return(n=n.toLowerCase(),t=t.toLowerCase(),n<t)?-1:n>t?1:0}),f=0;f<e.length;f++)con.println(e[f])}con.setColor();break}return _CLIP_PROC_ERR_COMMAND_NULL;case _CLIP_COMMAND_CUSTOM+3:for(addExtFuncList=!0,con.setColor("0000ff"),e=[],f=0,k=0;f<extFuncData.length;f++)d=extFuncName(extFuncFile[f]),d.length>0&&(e[k]=d,k++);for(e.sort(function(n,t){return(n=n.toLowerCase(),t=t.toLowerCase(),n<t)?-1:n>t?1:0}),f=0;f<e.length;f++)e[f].indexOf(".inc")>=0?con.println("<i>"+e[f]+"<\/i>"):(con.print(e[f]+"&nbsp;-&nbsp;"),n.usage(e[f],t,!1),con.println());con.setColor();addExtFuncList=!1;break;case _CLIP_COMMAND_CUSTOM+4:if(n._curLine._token.getToken()&&(p=getToken(),getCode()==_CLIP_CODE_EXTFUNC)){n.usage(p,t,!0);break}return _CLIP_PROC_ERR_COMMAND_NULL;case _CLIP_COMMAND_CUSTOM+7:if(v=new _Matrix,n._const(t,i,r,v)==_CLIP_NO_ERR){testFlag=_INT(v.toFloat(0,0))!=0;break}return _CLIP_PROC_ERR_COMMAND_NULL;case _CLIP_COMMAND_CUSTOM+8:if(v=new _Matrix,n._const(t,i,r,v)==_CLIP_NO_ERR){traceLevel>0&&traceString.length>0&&canUseWriteFile()&&writeFile("clip_trace_"+time()+".log",traceString);traceString="";traceLevel=_INT(v.toFloat(0,0));setProcTraceFlag(traceLevel>0);break}return _CLIP_PROC_ERR_COMMAND_NULL;default:return _CLIP_PROC_ERR_COMMAND_NULL}return _CLIP_NO_ERR}function onWriteFileEnd(n){con.println("<b>["+n.fullPath+"]<\/b>")}function onStartPlot(){setProcTraceFlag(!1);silentErr=!0}function onEndPlot(){var n;setProcTraceFlag(traceLevel>0);silentErr=!1;var t=new _Integer,i=new _Integer,r=new _String,u=new _String;for(n=0;n<procError.num();n++)procError.get(n,t,i,r,u),errorProc(t._val,i._val,r.str(),u.str());procError.delAll()}function onStartRePlot(){onStartPlot()}function onEndRePlot(){onEndPlot()}function updateLanguage(){document.getElementById("button_cache_clear").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Clear cache":"外部関数ｷｬｯｼｭのｸﾘｱ")+"&nbsp;&nbsp;";document.getElementById("button_storage_clear").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Clear storage":"ｽﾄﾚｰｼﾞのｸﾘｱ")+"&nbsp;&nbsp;";document.getElementById("button_cookie_clear").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Clear cookie":"Cookieのｸﾘｱ")+"&nbsp;&nbsp;";document.getElementById("button_callfunc").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Call":"呼び出し")+"&nbsp;&nbsp;";document.getElementById("button_savefunc").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Save to memory":"メモリ保存")+"&nbsp;&nbsp;";document.getElementById("button_savecanvas").innerHTML="&nbsp;&nbsp;"+(englishFlag?"Download":"ダウンロード")+"&nbsp;&nbsp;";document.getElementById("static_tab").innerHTML=(englishFlag?"Tab width":"Tab幅")+":&nbsp;";document.getElementById("static_smart").innerHTML=englishFlag?"Smart":"スマート";document.getElementById("static_command_env").innerHTML=englishFlag?"List environment":"環境の一覧";document.getElementById("static_command_list_var").innerHTML=englishFlag?"List variables":"変数の一覧";document.getElementById("static_command_print_array_help").innerHTML=englishFlag?"List elements of array":"配列の要素一覧";document.getElementById("static_command_list_extfunc").innerHTML=englishFlag?"List external functions":"外部関数の一覧";document.getElementById("static_command_print_usage").innerHTML=englishFlag?"Print usage of external function":"外部関数の使用法表示";document.getElementById("static_command_trace").innerHTML=englishFlag?"Trace level":"トレース・レベル";englishFlag?(document.getElementById("lang_japanese").style.display="none",document.getElementById("lang_english").style.display="block",con.println("Type &apos;:japanese&apos; to Japanese mode.")):(document.getElementById("lang_english").style.display="none",document.getElementById("lang_japanese").style.display="block",con.println("Type &apos;:english&apos; to English mode."))}function onEditorUpdateText(n){document.getElementById("static_len").innerHTML=""+n;needSaveFunc=!0;document.getElementById("clip_savefunc").style.display="block"}function getFunc(n){return preference.get("_CLIP_!"+n,"")}function setFunc(n,t){preference.set("_CLIP_!"+n,t);topProc.clearFuncCache("!"+n)}function loadFunc(){var n=getFunc(String.fromCharCode(curFunc));editor.setText(n);document.getElementById("static_len").innerHTML=""+n.length}function saveFunc(){var r,n,t,i,f,u;if(needSaveFunc){if(r=String.fromCharCode(curFunc),n=editor.text(),setFunc(r,""+n),t=n.length,i=getFunc(r).length,t!=i)for(f=t-i,u=1;u<=f;u++)if(n=n.substring(0,t-u),setFunc(r,""+n),i=getFunc(r).length,n.length==i)break;t!=i&&(document.getElementById("static_len").innerHTML=""+t+" ("+(t-i)+" over)");updateSelectFunc1(document.getElementById("select_func"),curFunc-97);needSaveFunc=!1;document.getElementById("clip_savefunc").style.display="none"}}function doChangeFunc(n){saveFunc();selFunc=n.selectedIndex;curFunc=n.options[selFunc].value;loadFunc();preference.set("_CLIP_EDITOR_SelFunc",""+selFunc)}function callFunc(){saveFunc();var i=input.value,n=input.selectionStart,t="!!"+String.fromCharCode(curFunc)+" ";input.value=i.substr(0,n)+t+i.slice(n);input.setSelectionRange(n+t.length,n+t.length);input.focus()}function onChangeTabWidth(){var n=parseInt(document.getElementById("tab_width").value);n<0&&(n=0,document.getElementById("tab_width").value=""+n);cssSetPropertyValue(".textarea_func","tab-size",""+n);preference.set("_CLIP_EDITOR_Tab",""+n)}function doCheckSmart(){setEditorSmartFlag(document.getElementById("check_smart").checked);preference.set("_CLIP_EDITOR_Smart",""+(editorSmartFlag()?1:0))}function updateSelectFunc1(n,t){var i=97+t,r=getFunc(String.fromCharCode(i));n.options[t].innerHTML=r.length==0?""+String.fromCharCode(i):""+String.fromCharCode(i)+"&nbsp;&nbsp;"+makeExtFuncData(r,!1)[0]}function updateSelectFunc(){for(var t=document.getElementById("select_func"),n=0;n<26;n++)updateSelectFunc1(t,n)}function saveCanvas(){var n=canvas.element().toDataURL("image/png").replace("image/png","image/octet-stream");window.open(n,"save")}var testFlag=!1,traceLevel=0,traceString=new String,extFuncFile=[],extFuncData=[],_css_display_none=null,_css_display_block=null,_cookie_expires="Tue, 01 Jan 2030 00:00:00 GMT",_cookie_val,_cookie_s,_cookie_str,_storage_val,_storage_s,_storage_str,preference,input,_console_break,con,_canvas_env,_input_file_cnt,_input_file_num,inputFile,editor,selFunc,curFunc,needSaveFunc;_Preference.prototype={num:function(){return this.s?storageNum():this.c?cookieNum():0},getKey:function(n){return this.s?getStorageKey(n):this.c?getCookieKey(n):null},get:function(n,t){return this.s?getStorage(n,t):this.c?getCookie(n,t):t},set:function(n,t){this.s?setStorage(n,t):this.c&&setCookie(n,t)},clear:function(n){this.s?clearStorage(n):this.c&&clearCookie(n)},beginRead:function(n){this.s?beginStorageRead(n):this.c&&beginCookieRead(n)},read:function(){return this.s?storageRead():this.c?cookieRead():""},endRead:function(){this.s?endStorageRead():this.c&&endCookieRead()},beginWrite:function(){this.s?beginStorageWrite():this.c&&beginCookieWrite()},write:function(n){this.s?storageWrite(n):this.c&&cookieWrite(n)},endWrite:function(n){this.s?endStorageWrite(n):this.c&&endCookieWrite(n)}};_console_break="<br>";_Console.prototype={setMaxBlankLine:function(n){this._blankLine="";for(var t=0;t<=n;t++)this._blankLine+=_console_break},setMaxLen:function(n){this._maxLen=n},setColor:function(n){this._color=n==undefined?"":n},setBold:function(n){this._bold=n},setItalic:function(n){this._italic=n},lock:function(){this._lock=!0;this._needUpdate=!1},unlock:function(){this._lock=!1;this._needUpdate&&(this._update(),this._needUpdate=!1)},_update:function(){if(this._lock){this._needUpdate=!0;return}if(this._maxLen>0)while(this._html.length>this._maxLen){var n=this._html.indexOf(_console_break);if(n<0)break;this._html=this._html.slice(n+_console_break.length)}this._div.innerHTML=this._html;this._html.length>0&&onConsoleUpdate(this._id)},_add:function(n){n.length>0&&(this._bold&&(this._html.slice(-4)=="<\/b>"?this._html=this._html.substring(0,this._html.length-4):this._html+="<b>"),this._italic&&(this._html.slice(-4)=="<\/i>"?this._html=this._html.substring(0,this._html.length-4):this._html+="<i>"),this._color.length>0&&(this._html.slice(-7)=="<\/span>"&&this._color==this._lastColor?this._html=this._html.substring(0,this._html.length-7):this._html+="<span style='color:#"+this._color+"'>",this._lastColor=this._color),this._html+=n,this._color.length>0&&(this._html+="<\/span>"),this._italic&&(this._html+="<\/i>"),this._bold&&(this._html+="<\/b>"))},clear:function(){this._html="";this._update()},newLine:function(){this._html.length>=_console_break.length&&this._html.slice(-_console_break.length)!=_console_break&&(this._html+=_console_break,this._update())},print:function(n){n!=undefined&&(this._add(n),this._update())},println:function(n){var t=!1;n!=undefined&&(this._add(n),t=!0);this._blankLine.length>0&&this._html.length>=this._blankLine.length?this._html.slice(-this._blankLine.length)!=this._blankLine&&(this._html+=_console_break,t=!0):(this._html+=_console_break,t=!0);t&&this._update()},scrollBottom:function(){this._div.scrollTop=this._div.scrollHeight}};_Error.prototype={message:function(){return this._message},name:function(){return this._name},description:function(){return this._description},number:function(){return this._number},file:function(){return this._file},line:function(){return this._line},column:function(){return this._column},stack:function(){return this._stack}};_Canvas.prototype={element:function(){return this._canvas},context:function(){return this._context},_resetContext:function(){this._context.textAlign="left";this._context.textBaseline="bottom";this._setColor();this._setFont();this._setStrokeWidth()},setSize:function(n,t){this._create?(this._canvas.width=n,this._canvas.height=t):(this._canvas.setAttribute("width",""+n),this._canvas.setAttribute("height",""+t));this._resetContext()},left:function(){if(this._create)return 0;for(var n=this._canvas,t=0;n;)t+=n.offsetLeft,n=n.offsetParent;return t},top:function(){if(this._create)return 0;for(var n=this._canvas,t=0;n;)t+=n.offsetTop,n=n.offsetParent;return t},width:function(){return parseInt(this._canvas.width)},height:function(){return parseInt(this._canvas.height)},_setColor:function(){var n;n=_canvas_env._color_a==255?"rgb("+_canvas_env._color_r+","+_canvas_env._color_g+","+_canvas_env._color_b+")":"rgba("+_canvas_env._color_r+","+_canvas_env._color_g+","+_canvas_env._color_b+","+_canvas_env._color_a/255+")";this._context.fillStyle=n;this._context.strokeStyle=n},setColor:function(n,t,i,r){r==undefined&&(r=255);(n!=_canvas_env._color_r||t!=_canvas_env._color_g||i!=_canvas_env._color_b||r!=_canvas_env._color_a)&&(_canvas_env._color_r=n,_canvas_env._color_g=t,_canvas_env._color_b=i,_canvas_env._color_a=r,this._setColor())},setColorRGB:function(n){this.setColor((n&16711680)>>16,(n&65280)>>8,n&255)},setColorBGR:function(n){this.setColor(n&255,(n&65280)>>8,(n&16711680)>>16)},_setFont:function(){_canvas_env._font.length>0&&(this._context.font=_canvas_env._font)},setFont:function(n,t){_canvas_env._font=""+n+"px "+(t.indexOf(" ")>=0?"'"+t+"'":t);this._setFont()},_setStrokeWidth:function(){this._context.lineWidth=_canvas_env._stroke_width},setStrokeWidth:function(n){_canvas_env._stroke_width=n;this._setStrokeWidth()},clearClip:function(){this._context.restore();this._resetContext()},setClip:function(n,t,i,r){!this._context.clip||(this.clearClip(),this._context.save(),this._context.beginPath(),this._context.moveTo(n,t),this._context.lineTo(n+i,t),this._context.lineTo(n+i,t+r),this._context.lineTo(n,t+r),this._context.closePath(),this._context.clip())},clear:function(n,t,i,r){n==undefined&&t==undefined&&i==undefined&&r==undefined?this._canvas.width=this._canvas.width:i==undefined&&r==undefined?this._context.clearRect(n,t,1,1):this._context.clearRect(n,t,i,r);this._resetContext()},put:function(n,t){this._context.fillRect(n,t,1,1)},fill:function(n,t,i,r){this._context.fillRect(n,t,i,r)},line:function(n,t,i,r,u){this._context.beginPath();u==undefined?(this._context.moveTo(n+.5,t+.5),this._context.lineTo(i+.5,r+.5)):(this._context.moveTo((n+.5)*u,(t+.5)*u),this._context.lineTo((i+.5)*u,(r+.5)*u));this._context.stroke();this._context.closePath()},rect:function(n,t,i,r,u){u==undefined?this._context.strokeRect(n+.5,t+.5,i,r):this._context.strokeRect((n+.5)*u,(t+.5)*u,i*u,r*u)},circle:function(n,t,i){this._context.beginPath();this._context.arc(n,t,i,0,Math.PI*2,!1);this._context.stroke()},drawString:function(n,t,i){!this._context.fillText||this._context.fillText(n,t,i)},drawImage:function(n,t,i){t==n.width&&i==n.height?this._context.drawImage(n,0,0):this._context.drawImage(n,0,0,n.width,n.height,0,0,t,i)},imageData:function(n,t){return this._context.getImageData(0,0,n,t)}};var canvas,canvasScale=1,canvasMinScale=1,canvasMinSize=128;_InputFile.prototype={element:function(){return this._input}};_ProcError.prototype={add:function(n,t,i,r){for(var f=this._top,u;;){if(f==null)break;if(f._err==n&&f._num==t&&f._func==i&&f._token==r)return;f=f._next}u=new __ProcError;this._top==null?(this._top=u,this._end=u):(u._before=this._end,this._end._next=u,this._end=u);u._err=n;u._num=t;u._func=i;u._token=r;this._num++},delAll:function(){this._top=null;this._num=0},get:function(n,t,i,r,u){for(var e=0,f=this._top;;){if(f==null)return!1;if(e==n)break;e++;f=f._next}return t.set(f._err),i.set(f._num),r.set(f._func),u.set(f._token),!0},num:function(){return this._num},isError:function(){for(var n=this._top;n!=null;){if((n._err&_CLIP_PROC_WARN)==0)return!0;n=n._next}return!1}};var procError,silentErr=!1,_editor_cursor_pos=0,_editor_text="",_editor_smart=!0;_Editor.prototype={element:function(){return this._textarea},text:function(){return this._textarea.value},setText:function(n){this._textarea.value=n;_editor_cursor_pos=this._textarea.selectionStart;_editor_text=this._textarea.value}};var topProc,topParam,needGUpdate=!1,addExtFuncList=!1,englishFlag=!1,lastTouchEnd=0;needSaveFunc=!1